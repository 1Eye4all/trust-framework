<!--
  User: bkeyes, wkim
  Date: 8/15/14
  Time: 1:07 PM
-->

<div>
	<div>
		<span class="label label-danger">{{error}}</span>
	</div>
</div>

<h3>Instance Builder</h3>

<div>
	<button type="button" class="btn btn-default" ng-click="postInstance()">Send Instance</button>
</div>

<div class="list-group">
	<div class="card" ng-repeat="card in instanceCards">
		<div class="panel-info">
			<div class="panel-heading">
				<div class="panel-title"><a href="#/card/{{card.id}}">{{card.title}}</a></div>

				<div class="btn-group-sm">
					<button type="button" class="btn btn-default" ng-click="selectTxt.businessTxt(card)">business</button>
					<button type="button" class="btn btn-default" ng-click="selectTxt.legalTxt(card)">legal</button>
					<button type="button" class="btn btn-default" ng-click="selectTxt.technicalTxt(card)">technical</button>
				</div>
			</div>
			<div class="panel-body">
				<div strip-br="true" ng-model="card.businessTxt" ng-show="card.businessSelected">{{card.businessTxt}}</div>
				<div strip-br="true" ng-model="card.legalTxt" ng-show="card.legalSelected">{{card.legalTxt}}</div>
				<div strip-br="true" ng-model="card.technicalTxt" ng-show="card.technicalSelected">{{card.technicalTxt}}</div>
				<div>{{card.currentTxt}}</div>
				<br> Provides:
				<p>
					<span ng-repeat="tag in card.providesTags"> <span class="label label-warning">{{tag.name}}</span>
					</span> <br> Depends on: <br>
				<div class="dependencies btn-group btn-group-lg">

					<div class="btn-group" ng-repeat="dependency in card.dependencies">
						<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" ng-disabled="dependency.chosen">
							{{dependency.description}}<br> Required tags:
							<p>
								<span ng-repeat="tag in dependency.tags"> <span class="label label-warning">{{tag.name}}</span>
								</span>
						</button>
						<ul class="dropdown-menu" role="menu">
							<li class="candidateCard" ng-repeat="candidate in getCandidateCards(dependency)"
								ng-click="instanceCards.push(candidate); addJsonInstanceCard(candidate, card); dependency.chosen=true">{{candidate.title}}</li>
						</ul>
					</div>

				</div>
			</div>

		</div>
	</div>
</div>

